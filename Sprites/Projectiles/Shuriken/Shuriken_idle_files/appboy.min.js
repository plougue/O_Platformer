/*
 appboy v0.2.4
 (c) Appboy Inc. 2015 - http://appboy.com
 License available at https://github.com/Appboy/appboy-web-sdk/blob/master/LICENSE
 Compiled on 2015-09-24
*/
function D(f){function E(a){if(a=a.querySelectorAll(".ab-close-button")[0])a.className=a.className.replace("fa-times","fa-times-circle")}function F(a,c,d,e){if(0<a.buttons.length){var g=document.createElement("div");g.className="ab-message-buttons";G(g,a.backgroundColor);e.insertBefore(g,e.firstChild);for(var h=function(g){return function(h){h=h||window.event;c.eb(g,a);g.clickAction===b.h.j.URI?window.open(g.uri):g.clickAction===b.h.j.NEWS_FEED&&d();a.U(e);h.stopPropagation()}},m=0;m<a.buttons.length;m++){var f=
a.buttons[m],l=document.createElement("button");l.className="ab-message-button";l.appendChild(document.createTextNode(f.text));l.style.backgroundColor=b.ba.ia(f.backgroundColor);l.style.color=b.ba.ia(f.textColor);l.onclick=h(f);g.appendChild(l)}}}function G(a,c){var d=document.createElement("div");d.className="ab-mask";a.appendChild(d);d=document.createElement("div");d.className="ab-background";d.style.backgroundColor=b.ba.ia(c);a.appendChild(d)}function B(a){a.Vb(function(a){if(!a.doNotLoadFontAwesome){a=
document.styleSheets;for(var b=!1,c=0;c<a.length;c++)if(null!=a[c].href&&(-1!==a[c].href.indexOf("/font-awesome.min.css")||-1!==a[c].href.indexOf("/font-awesome.css"))){b=!0;break}b||(a=document.createElement("link"),a.setAttribute("rel","stylesheet"),a.setAttribute("href","//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"),document.getElementsByTagName("head")[0].appendChild(a))}});var c={zd:function(){return a.Ec(function(a){c.Cc(a[0]);return a.slice(1)})},Cc:function(c){if(null==
c||!(c instanceof b.h))return!1;if(c instanceof b.Z||c instanceof b.Y)if(0<document.querySelectorAll(".ab-modal").length||0<document.querySelectorAll(".ab-fullscreen").length)return b.b.info("Could not display in-app message '"+c.message+"' because another message is already being displayed.  This message will be returned to the queue for future handling."),c.Ib=!0,!1;var e=this,g=c.aa(a,function(){e.Bc()}),h=document.getElementsByTagName("body")[0];if(c instanceof b.Z||c instanceof b.Y){var m=document.createElement("div");
m.className="ab-page-blocker ab-show";h.appendChild(m)}else m=document.querySelectorAll(".ab-slideup"),m=m[m.length-1],c.slideFrom===b.h.H.TOP?null==m?g.style.top=0:g.style.top=m.offsetTop+m.offsetHeight+"px":null==m?g.style.bottom=0:g.style.bottom=(window.innerHeight||document.documentElement.clientHeight)-m.offsetTop+"px";h.appendChild(g);a.gb(c);c.dismissType===b.h.w.AUTO_DISMISS&&setTimeout(function(){h.contains(g)&&(c.U(g),c.S())},c.duration);return!0},Bc:function(c,e,g){function h(a,c){if(null==
c)return a;var d,e=[];for(d=0;d<c.length;d++)e.push(c[d].toLowerCase());for(var g=[],h=0;h<a.length;h++){var m=[];for(d=0;d<a[h].categories.length;d++)m.push(a[h].categories[d].toLowerCase());0<b.I.pc(m,e).length&&g.push(a[h])}return g}null==c&&(c=document.getElementsByTagName("body")[0]);var m=!1,f=null;null==e?(f=a.Ya(),f.Hc(h(f.cards,g),f.lastUpdated),m=!0):f=new b.A(h(e,g),new Date);var l=f.aa(a);if(m){if(null==f.lastUpdated||Date.now()-f.lastUpdated.valueOf()>b.A.a)b.b.info("Cached feed was older than max TTL of "+
b.A.a+" ms, requesting an update from the server."),a.Ia(),e=l.querySelectorAll(".ab-refresh-button")[0],null!=e&&(e.className+=" fa-spin");e=a.Dc(function(b){var c=l.querySelectorAll(".ab-refresh-button")[0];null!=c&&(c.className=c.className.replace(/fa-spin/,""));f.Hc(h(b.cards,g),b.lastUpdated,l,a)});f.Td(e,l)}e=c.querySelectorAll(".ab-feed");for(var m=null,n=0;n<e.length;n++)e[n].parentNode===c&&(m=e[n]);null!=m?(b.A.U(a,m),m.parentNode.replaceChild(l,m)):c.appendChild(l);f.Hb(a,l)},Id:function(){for(var c=
document.querySelectorAll(".ab-feed"),e=0;e<c.length;e++)b.A.U(a,c[e])}};return c}function C(a,c,d){var e={};e[a]=c;return d.M(b.f.S,e)}function I(a,c){var d;d=[a];if(null===c)return null;if(null==c){var e={};e[b.f.j]=d;return e}if((e=z(c))&&null!=c[b.f.j])c[b.f.j].push(a);else if(e&&null!=c[b.f.a])for(c[b.f.j]=d;-1!==(d=c[b.f.a].indexOf(a));)c[b.f.a].splice(d,1);else{if(!(c instanceof Array))return b.b.error("Attempted to remove from custom attribute array but it is not an array."),!1;for(;-1!==
(d=c.indexOf(a));)c.splice(d,1)}return c}function J(a,c){var d=[a];if(null===c)return d;if(null==c){var e={};e[b.f.a]=d;return e}if((e=z(c))&&null!=c[b.f.a])c[b.f.a].push(a);else if(e&&null!=c[b.f.j])for(c[b.f.a]=d;-1!==(d=c[b.f.j].indexOf(a));)c[b.f.j].splice(d,1);else{if(!(c instanceof Array))return b.b.error("Attempted to add to custom attribute array but it is not an array."),!1;c.push(a)}return c}function K(a,c){if(null===c)return a;if(null==c){var d={};d[b.f.k]=a;return d}return z(c)&&null!=
c[b.f.k]?(c[b.f.k]+=a,c):isNaN(parseInt(c))?(b.b.error("Attempted to increment attribute but it is not an integer."),!1):c+a}function z(a){return null!=a&&"object"===typeof a&&!(a instanceof Array)}function H(a){function c(a,c,d,e,g){null==a&&(a={});if("object"!==typeof a||a instanceof Array)return b.b.error(c+" requires that "+d+" be an object. Ignoring "+g+"."),null;for(var h in a){if(!b.B.a(h,e,"the "+g+" property name"))return null;c=a[h];if(null==c)b.b.info("The "+g+' property "'+h+'" is '+c+
".  Removing from "+d+"."),delete a[h];else{if(!b.B.$(c,e,"the "+g+' property "'+h+'"'))return null;c instanceof Date&&(a[h]=b.X.Gc(c))}}return a}function d(){if(null==h)throw Error("Appboy must be initialized before calling methods.");}var e={Ed:function(a,c,d,e){null==d&&(d={});var h=b.za.w(a);b.Cb.Fa();var f=new b.Qa(h);return new b.C(a,c,null!=d[g.Ma]?d[g.Ma]:"https://dev.appboy.com/api/v3",new b.Pa(h,f,d[g.fd]),new b.Oa(b.Cb,h),f,h,e)},mc:function(){return new b.ca},Cd:function(a){return new b.sa(a)},
Bd:function(a,c){return new b.wa(c,b.za.w(a))},Dd:function(a){return new b.L(a)}};null==a&&(a=e);var g={Sc:"enableLogging",Ma:"baseUrl",fd:"sessionTimeoutInSeconds"},h,m,f,l,n,q,p,k,u=new b.ca,r=[];b.J={};b.J.bc=100;b.J.Yb=255;b.J.pb=-1;b.J.ob="inAppMessage must be an ab.InAppMessage object";b.J.cc="must be an ab.Card object";return{Vb:function(a){return u.ua(a)},Jb:function(c,d){b.b.Fa(null!=d&&d[g.Sc]);if(null!=h)return b.b.info("Appboy has already been initialized with an API key."),!0;if(null==
c||""===c||"string"!==typeof c)return b.b.error("Appboy requires a valid API key to be initialized."),!1;h=c;m=d||{};l=a.mc();r.push(l);n=a.Bd(h,l);p=a.mc();r.push(p);q=a.Cd(p);f=a.Ed(h,"0.2.4",m,function(a){null!=h&&(n.Md(a),q.Nd(a))});f.Jb();k=a.Dd(f.Za());var e="Initialized ";m&&m[g.Ma]&&(e+='for the Appboy backend at "'+m[g.Ma]+'" ');b.b.info(e+('with API key "'+c+'".'));u.ha(m);return!0},Ea:function(){b.b.info("Destroying appboy instance");b.b.Ea();null!=h&&(n.clearData(),n=null,q.clearData(),
q=null,l.P(),l=null,p.P(),p=null,f.Ea(),h=m=k=f=null,r=[])},Wb:function(){b.b.Wb()},Tb:function(a){b.b.Tb(a)},hb:function(){d();f.hb()},Db:function(a){d();null==a||0===a.length?b.b.error("changeUser requires a non-empty userId."):f.Db(a.toString(),q,n)},Za:function(){d();return f.Za()},Nb:function(){d();f.Nb()},Ia:function(){d();f.Ia()},Dc:function(a){d();return l.ua(a)},Ya:function(){d();return n.Ya()},Ec:function(a){d();return p.ua(a)},Ob:function(a){d();null==a&&(a=1);a=parseInt(a);isNaN(a)||a!==
b.J.pb&&0>a?b.b.error("Received invalid count for requestInAppMessageRefresh.  Count must be a positive number or "+b.J.pb+" for all messages."):0===a?q.tc():f.Ob(a)},gb:function(a){d();return a instanceof b.h?f.gb(a):(b.b.error(b.J.ob),!1)},fb:function(a){d();return a instanceof b.h?f.fb(a):(b.b.error(b.J.ob),!1)},eb:function(a,c){d();return a instanceof b.h.a?c instanceof b.h?f.eb(a,c):(b.b.error(b.J.ob),!1):(b.b.error("button must be an ab.InAppMessage.Button object"),!1)},cb:function(a){d();if(!(a instanceof
Array))return b.b.error("cards must be an array"),!1;for(var c=0;c<a.length;c++)if(!(a[c]instanceof b.m))return b.b.error("Each card in cards "+b.J.cc),!1;return f.cb(a)},bb:function(a){d();return a instanceof b.m?f.bb(a):(b.b.error("card "+b.J.cc),!1)},Q:function(a){d();for(var b=0;b<r.length;b++)r[b].Q(a);u.Q(a)},P:function(){d();for(var a=0;a<r.length;a++)r[a].P()},Kb:function(a,e){d();if(null==a||0>=a.length)return b.b.error('logCustomEvent requires a non-empty eventName, got "'+a+'". Ignoring event.'),
!1;if(!b.B.a(a,"log custom event","the event name"))return!1;e=c(e,"logCustomEvent","eventProperties",'log custom event "'+a+'"',"event");if(null==e)return!1;f.Kb(a,e);b.b.info('Logged custom event "'+a+'".');return!0},Lb:function(a,e,g,h,m){d();null==g&&(g="USD");null==h&&(h=1);if(null==a||0>=a.length)return b.b.error('logPurchase requires a non-empty productId, got "'+a+'". Ignoring purchase.'),!1;if(!b.B.a(a,"log purchase","the purchase name"))return!1;var l=parseFloat(e);if(isNaN(l))return b.b.error("logPurchase requires a numeric price, received "+
e+". Ignoring purchase."),!1;l=l.toFixed(2);e=parseInt(h);if(isNaN(e))return b.b.error("logPurchase requires an integer quantity, received "+h+". Ignoring purchase."),!1;if(1>e||e>b.J.bc)return b.b.error("logPurchase requires a quantity between 1 and "+b.J.bc+", received "+e+". Ignoring purchase."),!1;g=g.toUpperCase();if(-1==="AED AFN ALL AMD ANG AOA ARS AUD AWG AZN BAM BBD BDT BGN BHD BIF BMD BND BOB BRL BSD BTC BTN BWP BYR BZD CAD CDF CHF CLF CLP CNY COP CRC CUC CUP CVE CZK DJF DKK DOP DZD EEK EGP ERN ETB EUR FJD FKP GBP GEL GGP GHS GIP GMD GNF GTQ GYD HKD HNL HRK HTG HUF IDR ILS IMP INR IQD IRR ISK JEP JMD JOD JPY KES KGS KHR KMF KPW KRW KWD KYD KZT LAK LBP LKR LRD LSL LTL LVL LYD MAD MDL MGA MKD MMK MNT MOP MRO MTL MUR MVR MWK MXN MYR MZN NAD NGN NIO NOK NPR NZD OMR PAB PEN PGK PHP PKR PLN PYG QAR RON RSD RUB RWF SAR SBD SCR SDG SEK SGD SHP SLL SOS SRD STD SVC SYP SZL THB TJS TMT TND TOP TRY TTD TWD TZS UAH UGX USD UYU UZS VEF VND VUV WST XAF XAG XAU XCD XDR XOF XPD XPF XPT YER ZAR ZMK ZMW ZWL".split(" ").indexOf(g))return b.b.error("logPurchase received invalid currencyCode.  The currencyCode "+
g+" is not in the supported list of currencies. Ignoring purchase."),!1;m=c(m,"logPurchase","purchaseProperties",'log purchase "'+a+'"',"purchase");if(null==m)return!1;f.Lb(a,l,g,e,m);b.b.info("Logged "+e+" purchase"+(1<e?"s":"")+' of "'+a+'" for '+g+" "+l+".");return!0},Pd:function(){d();return k.tb},Sd:function(a){d();return k.Xd(a)},$d:function(){d();return k.ae()}}}var b={};"undefined"===typeof console&&(window.console={log:function(){}});Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return g.apply(this.prototype&&
this instanceof d?this:a,e.concat(Array.prototype.slice.call(arguments)))}function d(){}if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),g=this;d.prototype=this.prototype;b.prototype=new d;return b});void 0===Object.create&&(Object.create=function(a){function b(){}b.prototype=a;return new b});Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var d=this.length>>>0,e=Number(b)||
0,e=0>e?Math.ceil(e):Math.floor(e);for(0>e&&(e+=d);e<d;e++)if(e in this&&this[e]===a)return e;return-1});Event.prototype.stopPropagation||(Event.prototype.stopPropagation=function(){this.cancelBubble=!0});Event.prototype.preventDefault||(Event.prototype.preventDefault=function(){this.returnValue=!1});Date.now||(Date.now=function(){return(new Date).valueOf()});b.Oa=function(a,b){this.rb=a;this.o=b};b.Oa.prototype.Kd=function(){var a=this.o.Ja(b.i.a.Zb);null==a&&(a=new b.ea(b.xa.k()),this.o.Ub(b.i.a.Zb,
a));return new b.ac(a.pa,this.rb.Va,this.rb.ed,screen.width+"x"+screen.height,this.rb.language,this.td())};b.Oa.prototype.td=function(){return this.rd()};b.Oa.prototype.rd=function(){var a=(new Date).getTimezoneOffset(),b=parseInt(a/60),d=parseInt(a%60),e="GMT";0!==a&&(e=e+(0>a?"+":"-")+(("00"+Math.abs(b)).slice(-2)+":"+("00"+Math.abs(d)).slice(-2)));return e};b.L=function(a){this.vb=a;this.tb="serviceWorker"in navigator&&"undefined"!==typeof ServiceWorkerRegistration&&"showNotification"in ServiceWorkerRegistration.prototype&&
"PushManager"in window};b.L.j="Push notifications are not supported in this browser.";b.L.a="catch";b.L.prototype.kc=function(){return"denied"===Notification.permission};b.L.prototype.lc=function(a,b){a.kb&&"function"===typeof b&&b(a.kb);var d;0!==a.Wa.indexOf("https://android.googleapis.com/gcm/send")?d=a.Wa:(d=a.Wa,a.kb&&-1===a.Wa.indexOf(a.kb)&&(d=a.Wa+"/"+a.kb));d=d.split("/").pop();this.vb.wc(d)};b.L.prototype.xd=function(){this.vb.wc("")};b.L.prototype.Xd=function(a){if(this.tb){var c=this;
navigator.a.register("/service-worker.js").then(function(){c.kc()?b.b.info("The user has blocked notifications from this site."):navigator.a.ready.then(function(d){d.uc.Ld().then(function(e){if(e)b.b.info("User already subscribed to push."),c.lc(e,a);else d.uc.subscribe().then(function(d){b.b.info("User successfully subscribed to push.");c.vb.Ac(b.f.H.OPTED_IN);c.lc(d,a)})[b.L.a](function(a){c.kc()?b.b.info("Permission for push notifications were denied."):b.b.error("Push notification subscription failed. Be sure to check that your manifest file is correctly configured:"+
a)})})[b.L.a](function(a){b.b.error("Error during checking current push subscriptions: "+a)})})})[b.L.a](function(a){b.b.error("ServiceWorker registration failed: "+a)})}else b.b.info(b.L.j)};b.L.prototype.ae=function(){if(this.tb){var a=this;navigator.a.le().then(function(c){if(c)c.uc.Ld().then(function(d){d&&(a.xd(),d.unsubscribe().then(function(a){a?b.b.info("User successfully unsubscribed from push."):b.b.error("Failed to unsubscribe user from push.");c.unregister();b.b.info("Service worker successfully unregistered.")})[b.L.a](function(a){b.b.error("Unsubscription error: "+
a)}))})[b.L.a](function(a){b.b.error("Error thrown while unsubscribing from push messaging."+a)})})}else b.b.info(b.L.j)};b.Pa=function(a,b,d){this.o=a;this.r=b;d=parseFloat(d);isNaN(d)&&(d=1800);this.qd=d};b.Pa.prototype.jc=function(a,c){return new b.Event(this.r.K(),b.Event.a.hd,a,c.pa,{d:b.X.Eb(a-c.nc)})};b.Pa.prototype.W=function(){var a=Date.now(),c=a+1E3*this.qd,d=this.o.Ja(b.i.a.ya);if(null==d||d.Xa<a){var e="Generating session start event with time "+a;null!=d&&(this.o.T(this.jc(d.$a,d)),
e+=" (old session expired "+d.Xa+")");e+=". Will expire "+c.valueOf();b.b.info(e);d=new b.ea(b.xa.k(),c);this.o.T(new b.Event(this.r.K(),b.Event.a.jd,a,d.pa))}else d.$a=a,d.Xa=c;this.o.Ub(b.i.a.ya,d);return d.pa};b.Pa.prototype.Fd=function(){var a=this.o.Ja(b.i.a.ya);null!=a&&(this.o.T(this.jc(Date.now(),a)),this.o.Ud(b.i.a.ya))};b.za=function(){};b.i=function(a,b){this.zb=a;this.O=b};b.za.w=function(a){var c=!1;try{if(localStorage&&localStorage.getItem)try{localStorage.setItem(b.i.a.qb,!0),localStorage.getItem(b.i.a.qb)&&
(localStorage.removeItem(b.i.a.qb),c=!0)}catch(d){if(("QuotaExceededError"===d.name||"NS_ERROR_DOM_QUOTA_REACHED"===d.name)&&0<localStorage.length)c=!0;else throw d;}}catch(e){b.b.info("Local Storage not supported!")}var g=null,h=null;c?(g=new b.i.k(a),h=new b.i.k(a)):(g=b.za.S()?new b.i.w(a):new b.i.j,h=new b.i.j);return new b.i(g,h)};b.za.S=function(){return navigator.cookieEnabled||"cookie"in document&&(0<document.cookie.length||-1<(document.cookie="test").indexOf.call(document.cookie,"test"))};
b.i.a={qb:"ab.test",dc:"ab.storage.userId",Zb:"ab.storage.deviceId",ya:"ab.storage.sessionId",La:"ab.storage.events",ja:"ab.storage.attributes",$b:"ab.storage.device",Na:"ab.storage.cardImpressions",nb:"ab.storage.lastInAppMessageRefresh"};b.i.prototype.Ub=function(a,c){var d=c;null!=c&&c instanceof b.ea&&(d=c.Qb());this.zb.qa(a,d)};b.i.prototype.Ja=function(a){return b.ea.a(this.zb.da(a))};b.i.prototype.Ud=function(a){this.zb.remove(a)};b.i.prototype.T=function(a){if(null==a)return!1;var c=this.O.da(b.i.a.La);
null==c&&(c=[]);c.push(a.Qb());return this.O.qa(b.i.a.La,c)};b.i.prototype.oc=function(){var a=this.O.da(b.i.a.La);this.O.remove(b.i.a.La);null==a&&(a=[]);for(var c=[],d=0;d<a.length;d++)c.push(b.Event.j(a[d]));return c};b.i.prototype.jb=function(a,c){b.I.va(b.i.a,a,"StorageManager cannot store object.","ab.StorageManager.KEYS")&&this.O.qa(a,c)};b.i.prototype.ib=function(a){return b.I.va(b.i.a,a,"StorageManager cannot retrieve object.","ab.StorageManager.KEYS")?this.O.da(a):!1};b.i.prototype.Vd=function(a){b.I.va(b.i.a,
a,"StorageManager cannot remove object.","ab.StorageManager.KEYS")&&this.O.remove(a)};b.i.prototype.yb=function(a){return a||"ab.storage.attributes.anonymous_user"};b.i.prototype.rc=function(a){var c=this.O.da(b.i.a.ja);null==c&&(c={});var d=this.yb(a[b.f.w]),e;for(e in a)e===b.f.w||null!=c[d]&&null!=c[d][e]||this.zc(a[b.f.w],e,a[e])};b.i.prototype.zc=function(a,c,d){var e=this.O.da(b.i.a.ja);null==e&&(e={});var g=this.yb(a),h=e[g];null==h&&(h={},null!=a&&(h[b.f.w]=a));if(c===b.f.S){null==h[c]&&(h[c]=
{});for(var f in d){a=d[f];var v=h[c][f],l=null;if(z(a)){if(void 0!==a[b.f.k]&&(l=K(a[b.f.k],v),!l&&null!==l)||void 0!==a[b.f.a]&&(l=J(a[b.f.a],v),!l&&null!==l)||void 0!==a[b.f.j]&&(l=I(a[b.f.j],v),!l&&null!==l))return!1}else l=d[f];h[c][f]=l}}else h[c]=d;e[g]=h;return this.O.qa(b.i.a.ja,e)};b.i.prototype.Jd=function(){var a=this.O.da(b.i.a.ja);this.O.remove(b.i.a.ja);var c=[],d;for(d in a)null!=a[d]&&c.push(a[d]);return c};b.i.prototype.yd=function(a){var c=this.O.da(b.i.a.ja);if(null!=c){var d=
this.yb(null),e=c[d];null!=e&&(c[d]=void 0,this.O.qa(b.i.a.ja,c),e[b.f.w]=a,this.rc(e))}d=this.Ja(b.i.a.ya);c=null;null!=d&&(c=d.pa);d=this.oc();if(null!=d)for(e=0;e<d.length;e++){var g=d[e];null==g.Ka&&g.Rb==c&&(g.Ka=a);this.T(g)}};b.i.k=function(a){this.Aa=a};b.i.k.prototype.oa=function(a){return a+"."+this.Aa};b.i.k.prototype.qa=function(a,c){var d={v:c};try{return localStorage.setItem(this.oa(a),JSON.stringify(d)),!0}catch(e){return b.b.info("Storage failure: "+e.message),!1}};b.i.k.prototype.da=
function(a){try{var c=JSON.parse(localStorage.getItem(this.oa(a)));return null==c?null:c.v}catch(d){return b.b.info("Storage retrieval failure: "+d.message),!1}};b.i.k.prototype.remove=function(a){try{localStorage.removeItem(this.oa(a))}catch(c){return b.b.info("Storage removal failure: "+c.message),!1}};b.i.w=function(a){this.Aa=a};b.i.w.prototype.oa=function(a){return a+"."+this.Aa};b.i.w.prototype.qa=function(a,c){var d=new Date;d.setTime(d.getTime()+6311388E5);d="expires="+d.toUTCString();d=this.oa(a)+
"="+encodeURIComponent(JSON.stringify(c))+"; "+d;if(4093<=d.length)return b.b.info("Storage failure: encoded cookie string is "+d.length+" characters which is too large to store as a cookie."),!1;document.cookie=d;return!0};b.i.w.prototype.da=function(a){a=this.oa(a)+"=";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var e=b[d];" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(a))return JSON.parse(decodeURIComponent(e.substring(a.length,e.length)))}return null};b.i.w.prototype.remove=
function(a){document.cookie=this.oa(a)+"=;expires="+(new Date(0)).toGMTString()};b.i.j=function(){this.ub={};this.gc=5242880};b.i.j.prototype.qa=function(a,c){var d={value:c},e=this.wd(c);if(e>this.gc)return b.b.info("Storage failure: object is approximately "+e+" bytes which is greater than the max of "+this.gc),!1;this.ub[a]=d;return!0};b.i.j.prototype.wd=function(a){var b=[];a=[a];for(var d=0;a.length;){var e=a.pop();if("boolean"===typeof e)d+=4;else if("string"===typeof e)d+=2*e.length;else if("number"===
typeof e)d+=8;else if("object"===typeof e&&-1===b.indexOf(e)){b.push(e);for(var g in e)a.push(e[g])}}return d};b.i.j.prototype.da=function(a){a=this.ub[a];return null==a?null:a.value};b.i.j.prototype.remove=function(a){this.ub[a]=null};b.ca=function(){this.Da={}};b.ca.prototype.ua=function(a){if("function"!==typeof a)return null;var c=b.xa.k();this.Da[c]=a;return c};b.ca.prototype.Q=function(a){delete this.Da[a]};b.ca.prototype.P=function(){this.Da={}};b.ca.prototype.ha=function(a){var b=[],d;for(d in this.Da)b.push(this.Da[d](a));
return b};b.Qa=function(a){this.o=a};b.Qa.prototype.K=function(){var a=this.o.Ja(b.i.a.dc);return null!=a?a.pa:null};b.Qa.prototype.Od=function(a){var c=null==this.K();this.o.Ub(b.i.a.dc,new b.ea(a));c&&this.o.yd(a)};b.Qa.prototype.M=function(a,b){return this.o.zc(this.K(),a,b)};b.mb={Vc:"invalid_api_key",Oc:"blacklisted",dd:"no_device_identifier"};b.m=function(a,c,d,e,g,h,f,v,l,n,k,p,t){this.id=a;this.viewed=c||!1;this.title=d||"";this.imageUrl=e;this.description=g||"";this.created=h;this.updated=
f;this.categories=v||[];this.expiresAt=l;this.url=n;this.linkText=k;p=parseFloat(p);this.aspectRatio=isNaN(p)?null:p;this.extras=t;this.j=this.k=!1;this.a=new b.ca};b.m.prototype.Q=function(a){this.a.Q(a)};b.m.prototype.P=function(){this.a.P()};b.m.prototype.Mb=function(){return this.k?!1:this.viewed=this.k=!0};b.m.prototype.Ha=function(){return this.j?!1:(this.j=!0,this.a.ha(),this.viewed=!0)};b.m.N={Nc:"captioned_image",kd:"text_announcement",bd:"short_news",Lc:"banner_image"};b.m.vc={ce:"ADVERTISING",
de:"ANNOUNCEMENTS",ie:"NEWS",ke:"SOCIAL"};b.ka=function(a,c,d,e,g,h,f,v,l,n,k,p,t){b.m.call(this,a,c,d,e,g,h,f,v,l,n,k,p,t)};b.ka.prototype=Object.create(b.m.prototype);b.ka.prototype.constructor=b.ka;b.la=function(a,c,d,e,g,h,f,v,l,n,k,p,t){b.m.call(this,a,c,d,e,g,h,f,v,l,n,k,p,t)};b.la.prototype=Object.create(b.m.prototype);b.la.prototype.constructor=b.la;b.Banner=function(a,c,d,e,g,h,f,v,l,n,k){b.m.call(this,a,c,null,d,null,e,g,h,f,v,l,n,k)};b.Banner.prototype=Object.create(b.m.prototype);b.Banner.prototype.constructor=
b.Banner;b.m.V=function(a){var c=a.id,d=a.type,e=a.viewed,g=a.title,h=a.image,f=a.description,k=b.X.Gb(a.created),l=b.X.Gb(a.updated),n=a.categories,q=b.X.Gb(a.expires_at),p=a.url,t=a.domain,u=a.aspect_ratio;a=a.extras;return d===b.m.N.kd||d===b.m.N.bd?new b.la(c,e,g,h,f,k,l,n,q,p,t,u,a):d===b.m.N.Nc?new b.ka(c,e,g,h,f,k,l,n,q,p,t,u,a):d===b.m.N.Lc?new b.Banner(c,e,h,k,l,n,q,p,t,u,a):null};b.ac=function(a,b,d,e,g,h){this.id=a;this.Va=b;this.Qd=d;this.Wd=e;this.locale=g;this.timeZone=h};b.ac.prototype.Bb=
function(){return{browser:this.Va,os_version:this.Qd,resolution:this.Wd,locale:this.locale,time_zone:this.timeZone}};b.Event=function(a,b,d,e,g){this.Ka=a;this.type=b;this.time=d;this.Rb=e;this.data=g};b.Event.a={CustomEvent:"ce",Zc:"p",je:"pc",he:"ca",ge:"i",fe:"ie",Qc:"ci",Pc:"cc",jd:"ss",hd:"se",Yc:"si",Xc:"sc",Wc:"sbc",$c:"lr"};b.Event.prototype.Bb=function(){var a={name:this.type,time:b.X.Eb(this.time),data:this.data||{},session_id:this.Rb};null!=this.Ka&&(a.user_id=this.Ka);return a};b.Event.prototype.Qb=
function(){return{u:this.Ka,t:this.type,ts:this.time,s:this.Rb,d:this.data}};b.Event.j=function(a){return new b.Event(a.u,a.t,a.ts,a.s,a.d)};b.A=function(a,b){this.cards=a;this.lastUpdated=b};b.A.prototype.j=function(){for(var a=0,b=0;b<this.cards.length;b++)this.cards[b].viewed||a++;return a};b.ea=function(a,c,d){null==a&&(a=b.xa.k());null==d&&(d=Date.now());this.pa=a;this.nc=d;this.$a=Date.now();this.Xa=c};b.ea.prototype.Qb=function(){return{g:this.pa,e:this.Xa,c:this.nc,l:this.$a}};b.ea.a=function(a){if(null==
a||null==a.g)return null;var c=new b.ea(a.g,a.e,a.c);c.$a=a.l;return c};b.h=function(a,c,d,e,g,h,f,k,l,n,q,p,t,u,r,x,y,A,w){this.message=a;this.duration=l||5E3;this.slideFrom=c||b.h.H.BOTTOM;this.extras=d||[];this.campaignId=e;this.cardId=g;this.clickAction=h;this.uri=f;this.dismissType=k||b.h.w.AUTO_DISMISS;this.icon=n;this.imageUrl=q;this.iconColor=p||b.h.k.Ra;this.iconBackgroundColor=t||b.h.k.Xb;this.backgroundColor=u||b.h.k.Ra;this.textColor=r||b.h.k.lb;this.closeButtonColor=x||b.h.k.lb;this.header=
y;this.headerTextColor=A||b.h.k.lb;this.buttons=w||[];this.k=this.w=this.H=this.Ib=!1;this.j=new b.ca;this.a=new b.ca};b.h.prototype.V=function(a){return this.j.ua(a)};b.h.prototype.$=function(a){return this.a.ua(a)};b.h.prototype.Q=function(a){this.j.Q(a);this.a.Q(a)};b.h.prototype.P=function(){this.j.P();this.a.P()};b.h.prototype.Mb=function(){return this.H?!1:this.H=!0};b.h.prototype.Ha=function(){return this.w?!1:(this.w=!0,this.j.ha(),!0)};b.h.prototype.S=function(){this.k||(this.k=!0,this.a.ha())};
b.h.k={lb:4278190080,Ra:4294967295,Xb:4278219733,cd:3858759680};b.h.a=function(a,c,d,e,g,h){this.text=a||"";this.backgroundColor=c||b.h.k.Xb;this.textColor=d||b.h.k.Ra;this.clickAction=e||b.h.j.NEWS_FEED;this.uri=g;null==h&&(h=b.h.a.a);this.id=h;this.j=!1;this.a=new b.ca};b.h.a.a=-1;b.h.a.prototype.k=function(a){return this.a.ua(a)};b.h.a.prototype.Q=function(a){this.a.Q(a)};b.h.a.prototype.P=function(){this.a.P()};b.h.a.prototype.Ha=function(){return this.j?!1:(this.j=!0,this.a.ha(),!0)};b.h.a.j=
function(a){return new b.h.a(a.text,a.bg_color,a.text_color,a.click_action,a.uri,a.id)};b.h.H={TOP:"TOP",BOTTOM:"BOTTOM"};b.h.j={NEWS_FEED:"NEWS_FEED",URI:"URI",NONE:"NONE"};b.h.w={AUTO_DISMISS:"AUTO_DISMISS",MANUAL:"SWIPE"};b.h.N={gd:"SLIDEUP",ad:"MODAL",Uc:"FULL"};b.fa=function(a,c,d,e,g,h,f,k,l,n,q,p,t,u,r){r=r||b.h.k.Ra;u=u||b.h.k.cd;b.h.call(this,a,c,d,e,g,h,f,k,l,n,q,p,t,u,r,r)};b.fa.prototype=Object.create(b.h.prototype);b.fa.prototype.constructor=b.fa;b.fa.prototype.N=b.h.N.gd;b.Z=function(a,
c,d,e,g,h,f,k,l,n,q,p,t,u,r,x,y,A){f=f||b.h.w.MANUAL;b.h.call(this,a,null,c,d,e,g,h,f,k,l,n,q,p,t,u,r,x,y,A)};b.Z.prototype=Object.create(b.h.prototype);b.Z.prototype.constructor=b.Z;b.Z.prototype.N=b.h.N.ad;b.Y=function(a,c,d,e,g,h,f,k,l,n,q,p,t,u,r,x,y,A){f=f||b.h.w.MANUAL;b.h.call(this,a,null,c,d,e,g,h,f,k,l,n,q,p,t,u,r,x,y,A)};b.Y.prototype=Object.create(b.h.prototype);b.Y.prototype.constructor=b.Y;b.Y.prototype.N=b.h.N.Uc;b.h.$=function(a){var c=a.type;null!=c&&(c=c.toUpperCase());var d=a.message,
e=a.slide_from,g=a.extras,h=a.campaign_id,f=a.card_id,k=a.click_action,l=a.uri,n=a.message_close,q=a.duration,p=a.icon,t=a.image_url,u=a.icon_color,r=a.icon_bg_color,x=a.bg_color,y=a.text_color,A=a.close_btn_color,w=a.header,C=a.header_text_color,z=[];a=a.btns;null==a&&(a=[]);for(var B=0;B<a.length;B++)z.push(b.h.a.j(a[B]));if(c===b.Z.prototype.N)return new b.Z(d,g,h,f,k,l,n,q,p,t,u,r,x,y,A,w,C,z);if(c===b.Y.prototype.N)return new b.Y(d,g,h,f,k,l,n,q,p,t,u,r,x,y,A,w,C,z);if(c===b.fa.prototype.N)return new b.fa(d,
e,g,h,f,k,l,n,q,p,t,u,r,x,y);b.b.error("Ignoring message with unkown type "+c)};b.f=function(a,b){this.r=a;this.a=b};b.f.$=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/;
b.f.Ga=/^[0-9 .\\(\\)\\+\\-]+$/;b.f.V={MALE:"m",FEMALE:"f",OTHER:"o"};b.f.H={OPTED_IN:"opted_in",SUBSCRIBED:"subscribed",UNSUBSCRIBED:"unsubscribed"};b.f.w="user_id";b.f.S="custom";b.f.k="inc";b.f.a="add";b.f.j="remove";b.f.prototype.K=function(){return this.r.K()};b.f.prototype.Jc=function(a){return b.B.j(a,"set first name","the firstName")?this.r.M("first_name",a):!1};b.f.prototype.Rc=function(a){return b.B.j(a,"set last name","the lastName")?this.r.M("last_name",a):!1};b.f.prototype.vc=function(a){return null!=
a&&a.match(b.f.$)?this.r.M("email",a):(b.b.error('Cannot set email address - "'+a+'" did not pass RFC-5322 validation.'),!1)};b.f.prototype.S=function(a){return b.B.j(a,"set bio","the bio",5E3)?this.r.M("bio",a):!1};b.f.prototype.Kc=function(a){if(null==a)return!1;a=a.toLowerCase();return b.I.va(b.f.V,a,'Gender "'+a+'" is not a valid gender.',"ab.User.Genders")?this.r.M("gender",a):!1};b.f.prototype.Ga=function(a,c,d){a=parseInt(a);c=parseInt(c);d=parseInt(d);return isNaN(a)||isNaN(c)||isNaN(d)||
12<c||1>c||31<d||1>d?(b.b.error("Cannot set date of birth - parameters should comprise a valid date e.g. setDateOfBirth(1776, 7, 4);"),!1):this.r.M("dob",""+a+"-"+c+"-"+d)};b.f.prototype.V=function(a){return b.B.j(a,"set country","the country")?this.r.M("country",a):!1};b.f.prototype.Mc=function(a){return b.B.j(a,"set home city","the homeCity")?this.r.M("home_city",a):!1};b.f.prototype.be=function(a){return b.I.va(b.f.H,a,'Email notification setting "'+a+'" is not a valid subscription type.',"ab.User.NotificationSubscriptionTypes")?
this.r.M("email_subscribe",a):!1};b.f.prototype.Ac=function(a){return b.I.va(b.f.H,a,'Push notification setting "'+a+'" is not a valid subscription type.',"ab.User.NotificationSubscriptionTypes")?this.r.M("push_subscribe",a):!1};b.f.prototype.Tc=function(a){return b.B.j(a,"set phone number","the phoneNumber")?null!=a&&a.match(b.f.Ga)?this.r.M("phone",a):(b.b.error('Cannot set phone number - "'+a+'" did not pass validation.'),!1):!1};b.f.prototype.H=function(a){return this.r.M("image_url",a)};b.f.prototype.Sb=
function(a,c,d,e,g){if(null==a||null==c)return b.b.error("Cannot set last-known location - latitude and longitude are required parameters."),!1;a=parseFloat(a);c=parseFloat(c);null!=d&&(d=parseFloat(d));null!=e&&(e=parseFloat(e));null!=g&&(g=parseFloat(g));return isNaN(a)||isNaN(c)||null!=d&&isNaN(d)||null!=e&&isNaN(e)||null!=g&&isNaN(g)?(b.b.error("Cannot set last-known location - all supplied parameters must be numeric."),!1):90<a||-90>a||180<c||-180>c?(b.b.error("Cannot set last-known location. Latitude and longitude values are bounded by \u00b190 and \u00b1180 respectively."),
!1):null!=d&&0>d||null!=g&&0>g?(b.b.error("Cannot set last-known location. accuracy and altitudeAccuracy may not be negative."),!1):this.a.Sb(this.ee,a,c,e,d,g)};b.f.prototype.$=function(a,c){if(!b.B.a(a,"set custom user attribute","the given key"))return!1;var d=typeof c,e=c instanceof Date,g=c instanceof Array;if("number"!==d&&"boolean"!==d&&!e&&!g&&null!=c&&!b.B.a(c,'set custom user attribute "'+a+'"',"the given value"))return!1;e&&(c=b.X.Gc(c));if(g)for(var h in c)if(!b.B.a(c[h],'set custom user attribute "'+
a+'"',"the element in the given array"))return!1;return C(a,c,this.r)};b.f.prototype.j=function(a,c){if(!b.B.a(a,"add to custom user attribute array","the given key")||null!=c&&!b.B.a(c,"add to custom user attribute array","the given value"))return!1;var d={};d[b.f.a]=c;return C(a,d,this.r)};b.f.prototype.w=function(a,c){if(!b.B.a(a,"remove from custom user attribute array","the given key")||null!=c&&!b.B.a(c,"remove from custom user attribute array","the given value"))return!1;var d={};d[b.f.j]=
c;return C(a,d,this.r)};b.f.prototype.k=function(a,c){if(!b.B.a(a,"increment custom user attribute","the given key"))return!1;null==c&&(c=1);var d=parseInt(c);if(isNaN(d)||d!==parseFloat(c))return b.b.error('Cannot increment custom user attribute because the given incrementValue "'+c+'" is not an integer.'),!1;var e={};e[b.f.k]=d;return C(a,e,this.r)};b.f.prototype.wc=function(a){this.r.M("push_token",a)};b.wa=function(a,b){this.Ta=a;this.o=b;this.ga=[];this.Ca=null};b.wa.prototype.ud=function(a){for(var c=
[],d=null,e=this.o.ib(b.i.a.Na)||{},g={},h=0;h<a.length;h++)d=a[h],d=b.m.V(d),null!=d&&(e[d.id]&&(d.viewed=!0,g[d.id]=!0),c.push(d));this.o.jb(b.i.a.Na,g);this.ga=c;this.Ca=new Date};b.wa.prototype.Md=function(a){null!=a&&a.feed&&(this.ud(a.feed),this.Ta.ha(new b.A(this.ga.slice(),this.Ca)))};b.wa.prototype.Ya=function(){for(var a=[],c=0;c<this.ga.length;c++)(null==this.ga[c].expiresAt||this.ga[c].expiresAt>=new Date)&&a.push(this.ga[c]);return new b.A(a,this.Ca)};b.wa.prototype.clearData=function(){this.ga=
[];this.Ca=null;this.Ta.ha(new b.A(this.ga.slice(),this.Ca))};b.sa=function(a){this.Ta=a;this.sb=[]};b.sa.prototype.vd=function(a){for(var c=[],d=0;d<a.length;d++){var e=b.h.$(a[d]);null!=e&&c.push(e)}return c};b.sa.prototype.sd=function(a){null!=a&&this.sb.push(a)};b.sa.prototype.clearData=function(){var a=this.sb;this.sb=[];return a};b.sa.prototype.tc=function(a){null==a&&(a=[]);a=this.clearData().concat(a);if(0<a.length){for(var c=this.Ta.ha(a.slice())||[],c=b.I.pc.apply(this,c),d=0;d<a.length;d++)a[d].Ib&&
(a[d].Ib=!1,-1===c.indexOf(a[d])&&c.push(a[d]));for(d=0;d<c.length;d++)this.sd(c[d])}};b.sa.prototype.Nd=function(a){null!=a&&a.in_app_message&&this.tc(this.vd(a.in_app_message))};b.C=function(a,b,d,e,g,h,f,k){this.Aa=a;this.pd=b;this.md=d;this.od=10;this.hc=600;this.R=e;this.nd=g;this.r=h;this.o=f;this.ld=k};b.C.prototype.ta=function(a,c){null==a&&(a={});null==c&&(c=!0);var d=!0,e;for(e in a)a.hasOwnProperty(e)&&(d=!1);var g=this.o.oc(),h=this.o.Jd();if(c&&0===g.length&&0===h.length&&d)this.Ab();
else{if(0<g.length){d=[];for(e=0;e<g.length;e++)d.push(g[e].Bb());a.events=d}0<h.length&&(a.attributes=h);d=this.nd.Kd();e=d.Bb();var f=this.o.ib(b.i.a.$b);b.I.isEqual(f,e)||(a.device=e);a.api_key=this.Aa;a.time=b.X.Eb(Date.now(),!0);a.sdk_version=this.pd;a.device_id=d.id;var k=this;b.sc.V({url:""+this.md+"/data/",data:a,Fc:function(c){if(c.error){var d=c.error;c.error===b.mb.Vc?d='The given API key "'+a.api_key+'" is invalid.':c.error===b.mb.Oc?d="Sorry, we are not currently accepting your requests. If you think this is in error, please contact us.":
c.error===b.mb.dd&&(d="No device identifier. This should never happen. Please contact support@appboy.com");b.b.error("Backend error: "+d)}else null!=a.device&&k.o.jb(b.i.a.$b,a.device),null!=a.respond_with&&a.respond_with.user_id!=k.r.K()||k.ld(c)},error:function(){var a;for(a=0;a<g.length;a++)k.o.T(g[a]);for(a=0;a<h.length;a++)k.o.rc(h[a])},Ua:function(){c&&k.Ab()}})}};b.C.prototype.xb=function(a,c){var d={};null!=a&&(d.in_app_message={count:a},a===b.J.pb&&(d.in_app_message.all=!0));c&&(d.feed=c);
var e=this.r.K();null!=e&&(d.user_id=e);return{respond_with:d}};b.C.prototype.wb=function(a){if(null==a.campaignId&&null==a.cardId)return b.b.info("This in-app message contains neither a campaignId nor a cardId - not sending any event info to Appboy servers."),null;var c={};null!=a.cardId&&(c.card_ids=[a.cardId]);null!=a.campaignId&&(c.campaign_ids=[a.campaignId]);return c};b.C.prototype.ic=function(a){for(var b=null,d=0;d<a.length;d++)null!=a[d].id&&""!==a[d].id&&(b=b||{},b.ids=b.ids||[],b.ids.push(a[d].id));
return b};b.C.prototype.Ab=function(){if(!this.ec){null!=this.Ba&&clearTimeout(this.Ba);var a=this;this.Ba=setTimeout(function(){a.ta()},1E3*this.od)}};b.C.prototype.Jb=function(){this.ec=!1;this.Ab()};b.C.prototype.Ea=function(){null!=this.Ba&&clearTimeout(this.Ba);this.ec=!0;this.ta({},!1);this.Ba=null};b.C.prototype.hb=function(){this.R.W();var a={},c=Date.now(),d=this.o.ib(b.i.a.nb);(c-(d||0))/1E3>this.hc?(a=this.xb(1),this.o.jb(b.i.a.nb,c)):b.b.info("Not refreshing news feed and in-app messages because they were refreshed in the last "+
this.hc+" seconds.");this.ta(a)};b.C.prototype.Db=function(a,c,d){this.r.K()!==a?(this.R.Fd(),this.r.Od(a),c.clearData(),d.clearData(),this.o.Vd(b.i.a.nb),this.hb(),b.b.info('Changed user to "'+a+'".')):b.b.info('Current user is already "'+a+'". Doing nothing.')};b.C.prototype.Za=function(){return new b.f(this.r,this)};b.C.prototype.Nb=function(){this.R.W();this.ta()};b.C.prototype.Ia=function(){this.R.W();var a=this.xb(null,!0);this.ta(a)};b.C.prototype.Ob=function(a){this.R.W();a=this.xb(a);this.ta(a)};
b.C.prototype.Kb=function(a,c){var d=this.R.W();this.o.T(new b.Event(this.r.K(),b.Event.a.CustomEvent,Date.now(),d,{n:a,p:c}))};b.C.prototype.Lb=function(a,c,d,e,g){var h=this.R.W();this.o.T(new b.Event(this.r.K(),b.Event.a.Zc,Date.now(),h,{pid:a,c:d,p:c,q:e,pr:g}))};b.C.prototype.Sb=function(a,c,d,e,g,h){var f=this.R.W();c={latitude:c,longitude:d};null!=e&&(c.altitude=e);null!=g&&(c.ll_accuracy=g);null!=h&&(c.alt_accuracy=h);return this.o.T(new b.Event(a,b.Event.a.$c,Date.now(),f,c))};b.C.prototype.gb=
function(a){if(!a.Mb())return b.b.info("This in-app message has already received an impression. Ignoring request."),!1;var c=this.R.W();a=this.wb(a);return null==a?!1:this.o.T(new b.Event(this.r.K(),b.Event.a.Yc,Date.now(),c,a))};b.C.prototype.fb=function(a){if(!a.Ha())return b.b.info("This in-app message has already received a click. Ignoring request."),!1;if(a.clickAction===b.h.j.NONE)return b.b.info("This in-app message has a click action of "+b.h.j.NONE+". Not logging event to Appboy servers."),
!1;var c=this.R.W();a=this.wb(a);return null==a?!1:this.o.T(new b.Event(this.r.K(),b.Event.a.Xc,Date.now(),c,a))};b.C.prototype.eb=function(a,c){if(!a.Ha())return b.b.info("This in-app message button has already received a click. Ignoring request."),!1;if(a.clickAction===b.h.j.NONE)return b.b.info("This in-app message button has a click action of "+b.h.j.NONE+". Not logging event to Appboy servers."),!1;var d=this.R.W(),e=this.wb(c);if(null==e)return!1;if(a.id===b.h.a.a)return b.b.info("This in-app message button does not have a tracking id. Not logging event to Appboy servers."),
!1;null!=a.id&&(e.bid=a.id);return this.o.T(new b.Event(this.r.K(),b.Event.a.Wc,Date.now(),d,e))};b.C.prototype.cb=function(a){for(var c=[],d=this.o.ib(b.i.a.Na)||{},e=0;e<a.length;e++)a[e].Mb()?c.push(a[e]):b.b.info("Card "+a[e].id+" has already logged an impression."),d[a[e].id]=!0;if(0===c.length)return b.b.info("All cards have already logged an impression. Ingoring request."),!1;a=this.R.W();c=this.ic(c);if(null==c)return!1;this.o.jb(b.i.a.Na,d);return this.o.T(new b.Event(this.r.K(),b.Event.a.Qc,
Date.now(),a,c))};b.C.prototype.bb=function(a){if(!a.Ha())return b.b.info("Card "+a.id+" has already received a click. Ignoring request."),!1;if(null==a.url||""===a.url)return b.b.info("Card "+a.id+" has no url. Not logging click to Appboy servers."),!1;var c=this.R.W();a=this.ic([a]);return null==a?!1:this.o.T(new b.Event(this.r.K(),b.Event.a.Pc,Date.now(),c,a))};b.Cb={Fa:function(){this.Va=this.xc(this.Gd)||navigator.appName||"unknown browser";this.version=this.yc(navigator.userAgent)||this.yc(navigator.appVersion)||
navigator.appVersion||"unknown version";this.ed=this.xc(this.Hd)||"unknown OS";this.language=(navigator.k||navigator.language||navigator.browserLanguage||navigator.j||"").toLowerCase()},xc:function(a){for(var b=0;b<a.length;b++){var d=a[b].F,e=a[b].Rd;this.Ic=a[b].ra||a[b].D;if(d){if(-1!==d.indexOf(a[b].G))return a[b].D}else if(e)return a[b].D}},yc:function(a){var b=a.indexOf(this.Ic);if(-1!==b)return parseFloat(a.substring(b+this.Ic.length+1))},Yd:function(){return"Internet Explorer"===this.Va?8<
this.version:!0},Gd:[{F:navigator.userAgent,G:"Edge",D:"Edge"},{F:navigator.userAgent,G:"Chrome",D:"Chrome"},{F:navigator.userAgent,G:"CriOS",D:"Chrome",ra:"CriOS"},{F:navigator.userAgent,G:"OmniWeb",ra:"OmniWeb/",D:"OmniWeb"},{F:navigator.vendor,G:"Apple",D:"Safari",ra:"Version"},{Rd:window.opera,D:"Opera",ra:"Version"},{F:navigator.vendor,G:"iCab",D:"iCab"},{F:navigator.vendor,G:"KDE",D:"Konqueror"},{F:navigator.userAgent,G:"Firefox",D:"Firefox"},{F:navigator.vendor,G:"Camino",D:"Camino"},{F:navigator.userAgent,
G:"Netscape",D:"Netscape"},{F:navigator.userAgent,G:"MSIE",D:"Internet Explorer",ra:"MSIE"},{F:navigator.userAgent,G:"Trident",D:"Internet Explorer"},{F:navigator.userAgent,G:"Gecko",D:"Mozilla",ra:"rv"},{F:navigator.userAgent,G:"Mozilla",D:"Netscape",ra:"Mozilla"}],Hd:[{F:navigator.platform,G:"Win",D:"Windows"},{F:navigator.platform,G:"Mac",D:"Mac"},{F:navigator.userAgent,G:"iPhone",D:"iPhone/iPod"},{F:navigator.userAgent,G:"iPad",D:"iPad"},{F:navigator.platform,G:"Linux",D:"Linux"}]};b.I={};b.I.va=
function(a,c,d,e){var g=[],f;for(f in a)g.push(a[f]);return-1===g.indexOf(c)?(b.b.error(d+" Valid values from "+e+' are "'+g.join('"/"')+'".'),!1):!0};b.I.pc=function(a){null==a&&(a=[]);for(var b=[],d=arguments.length,e=0,g=a.length;e<g;e++){var f=a[e];if(-1===b.indexOf(f)){for(var k=1;k<d&&-1!==arguments[k].indexOf(f);k++);k===d&&b.push(f)}}return b};b.I.keys=function(a){var b=[];if(null!=a)for(var d in a)b.push(d);return b};b.I.isEqual=function(a,c){if(a===c)return 0!==a||1/a===1/c;if(null==a||
null==c)return a===c;var d=a.toString();if(d!==c.toString())return!1;switch(d){case "[object RegExp]":case "[object String]":return""+a===""+c;case "[object Number]":return+a!==+a?+c!==+c:0===+a?1/+a===1/c:+a===+c;case "[object Date]":case "[object Boolean]":return+a===+c}d="[object Array]"===d;if(!d){if("object"!==typeof a||"object"!==typeof c)return!1;var e=a.constructor,g=c.constructor;if(e!==g&&!(e instanceof Function&&e instanceof e&&g instanceof Function&&g instanceof g)&&"constructor"in a&&
"constructor"in c)return!1}for(var e=[],g=[],f=e.length;f--;)if(e[f]===a)return g[f]===c;e.push(a);g.push(c);if(d){f=a.length;if(f!==c.length)return!1;for(;f--;)if(!b.I.isEqual(a[f],c[f],e,g))return!1}else{var d=b.I.keys(a),k,f=d.length;if(b.I.keys(c).length!==f)return!1;for(;f--;)if(k=d[f],!c.hasOwnProperty(k)||!b.I.isEqual(a[k],c[k],e,g))return!1}e.pop();g.pop();return!0};b.X={};b.X.Eb=function(a,b){var d=a/1E3;b&&(d=Math.floor(d));return d};b.X.Gb=function(a){var b=parseInt(a);return null==a||
isNaN(b)?null:new Date(1E3*b)};b.X.Gc=function(a){return null!=a&&a instanceof Date?a.toISOString().replace(/\.[0-9]{3}Z$/,""):a};b.xa=function(){};b.xa.k=function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return a()+a(!0)+a(!0)+a()};b.b={Fa:function(a){if(void 0!==a||void 0===b.b.na)b.b.na=!!a;b.b.fc||(b.b.fc=!0,"undefined"===typeof console&&(window.console={log:function(){}}),b.b.Sa=Function.prototype.bind(console.log,
console))},Ea:function(){b.b.fc=!1;b.b.na=void 0;b.b.Sa=void 0},Tb:function(a){"function"!==typeof a?b.b.info("Ignoring setLogger call since logger is not a function"):(b.b.Fa(),b.b.Sa=a)},Wb:function(){b.b.Fa();b.b.na?(console.log("Disabling Appboy logging"),b.b.na=!1):(console.log("Enabled Appboy logging"),b.b.na=!0)},info:function(a){b.b.na&&b.b.Sa("Appboy: "+a)},error:function(a){b.b.na&&b.b.Sa("Appboy SDK Error: "+a)}};b.sc=function(){};b.sc.V=function(a){var c,d,e=!1;try{if(window.XMLHttpRequest&&
(c=new XMLHttpRequest)&&"undefined"!==typeof c.withCredentials||("undefined"!==typeof XDomainRequest?(c=new XDomainRequest,e=c.async=!0):b.b.error("This browser does not have any supported ajax options!")),null!=c){var f=function(){a.error instanceof Function&&a.error();a.Ua instanceof Function&&a.Ua()};c.onload=function(){var b=!1;if(e)b=!0;else{if(4!==c.readyState)return;b=200<=c.status&&300>c.status||304===c.status}b?(a.Fc instanceof Function&&a.Fc(JSON.parse(c.responseText)),a.Ua instanceof Function&&
a.Ua()):f()};c.onerror=function(){f()};c.ontimeout=function(){f()};d=JSON.stringify(a.data);if(e)c.onprogress=function(){},c.open("post",a.url);else{c.open("POST",a.url,!0);c.setRequestHeader("Content-type","application/json");c.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var h=a.headers||[],k=0;k<h.length;k++)c.setRequestHeader(h[k][0],h[k][1])}c.send(d)}}catch(v){b.b.error("Network request error: "+v.message)}};b.B=function(){};b.B.H=/^[^\$\x00-\x1F\x22][^\x00-\x1F\x22]{0,254}$/;b.B.j=
function(a,c,d,e){null==e&&(e=b.J.Yb);(e=null!=a&&"string"===typeof a&&a.length<=e)||b.b.error("Cannot "+c+" because "+d+' "'+a+'" is invalid.');return e};b.B.a=function(a,c,d){var e=null!=a&&"string"===typeof a&&(""===a||a.match(b.B.H));e||b.b.error("Cannot "+c+" because "+d+' "'+a+'" is invalid.');return e};b.B.$=function(a,c,d){var e=typeof a,f=a instanceof Date;(e=null!=a&&("number"===e||"boolean"===e||f||"string"===e&&a.length<=b.J.Yb))||b.b.error("Cannot "+c+" because "+d+' "'+a+'" is invalid.');
return e};b.ba={};b.ba.ia=function(a){a=parseInt(a);if(isNaN(a))return"";a>>>=0;var c=a&255,d=(a&65280)>>>8,e=(a&16711680)>>>16;return b.Cb.Yd()?"rgba("+[e,d,c,((a&4278190080)>>>24)/255].join()+")":"rgb("+[e,d,c].join()+")"};b.ba.me=function(a){a=parseInt(a);if(isNaN(a))return"";a>>>=0;return"rgb("+[(a&16711680)>>>16,(a&65280)>>>8,a&255].join()+")"};b.ma={};b.ma.qc=function(a,b,d){if(null==a)return!1;b=b||!1;d=d||!1;a=a.getBoundingClientRect();return null==a?!1:(0<=a.top||!b)&&(0<=a.left||!0)&&(0<=
a.bottom&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)||!d)&&(a.right<=(window.innerWidth||document.documentElement.clientWidth)||!0)};b.ma.Zd=function(a){return b.ma.qc(a,!0,!1)};b.ma.Ad=function(a){return b.ma.qc(a,!1,!0)};b.la.prototype.Fb="ab-classic-card";b.ka.prototype.Fb="ab-captioned-image";b.Banner.prototype.Fb="ab-banner";b.la.prototype.Pb=!1;b.ka.prototype.Pb=!0;b.Banner.prototype.Pb=!0;b.m.j="data-ab-had-top-impression";b.m.a="data-ab-had-bottom-impression";b.m.Ga=
function(a){return null!=a&&!!a.getAttribute(b.m.j)};b.m.w=function(a){null!=a&&a.setAttribute(b.m.j,!0)};b.m.S=function(a){return null!=a&&!!a.getAttribute(b.m.a)};b.m.k=function(a){null!=a&&a.setAttribute(b.m.a,!0)};b.m.H=function(a){null!=a&&(a=a.querySelectorAll(".ab-read-indicator")[0],null!=a&&(a.className+=" read"))};b.m.$=function(a){return a.getAttribute("data-ab-card-id")};b.m.prototype.aa=function(a){var c=document.createElement("div");c.className="ab-card "+this.constructor.prototype.Fb;
c.setAttribute("data-ab-card-id",this.id);if(this.imageUrl&&""!==this.imageUrl){var d=document.createElement("div");d.className="ab-image-area";var e=document.createElement("img");e.setAttribute("src",this.imageUrl);this.constructor.prototype.Pb&&(e.setAttribute("width",370),null!=this.aspectRatio&&e.setAttribute("height",370/this.aspectRatio));d.appendChild(e);c.appendChild(d);c.className+=" with-image"}d=document.createElement("div");d.className="ab-card-body";e=document.createElement("div");e.className=
"ab-read-dot";d.appendChild(e);e=document.createElement("div");e.className="ab-read-indicator";this.viewed&&(e.className+=" read",b.m.w(c),b.m.k(c));d.appendChild(e);e=document.createElement("div");e.className="ab-title";e.appendChild(document.createTextNode(this.title));d.appendChild(e);e=document.createElement("div");e.className="ab-description";e.appendChild(document.createTextNode(this.description));var f=this.url&&""!==this.url;if(f){var h=document.createElement("div");h.className="ab-url-area";
h.appendChild(document.createTextNode(this.linkText));e.appendChild(h)}d.appendChild(e);var k=this;c.onclick=function(){b.m.H(c);f&&(a(k),window.open(k.url))};c.appendChild(d);return this.url&&""!==this.url?(d=document.createElement("a"),d.className="ab-null-link",d.href=this.url,d.onclick=function(){return!1},d.appendChild(c),d):c};b.A.w=240;b.A.a=6E4;b.A.k="We have no updates for you at this time.<br/>Please check again later.";b.A.j="data-update-subscription-id";b.A.U=function(a,c){c&&(c.className=
c.className.replace("ab-show","ab-hide"),setTimeout(function(){c&&c.parentNode&&c.parentNode.removeChild(c)},b.A.w));var d=c.getAttribute(b.A.j);null!=d&&a.Q(d)};b.A.prototype.a=function(a){var c=document.createElement("div");c.className="ab-feed-body";if(null==this.lastUpdated){var d=document.createElement("div");d.className="ab-no-cards-message";var e=document.createElement("i");e.className="fa fa-spinner fa-spin fa-4x";d.appendChild(e);c.appendChild(d)}else{d=function(b){a.bb(b)};for(e=0;e<this.cards.length;e++)c.appendChild(this.cards[e].aa(d));
0===this.cards.length&&(d=document.createElement("div"),d.className="ab-no-cards-message",d.innerHTML=b.A.k,c.appendChild(d))}return c};b.A.prototype.Hb=function(a,c){if(null!=c){for(var d=[],e=c.querySelectorAll(".ab-card"),f=0;f<e.length;f++){var h=b.m.Ga(e[f]),k=b.m.S(e[f]),v=h,l=k,n=b.ma.Zd(e[f]),q=b.ma.Ad(e[f]);!h&&n&&(h=!0,b.m.w(e[f]));!k&&q&&(k=!0,b.m.k(e[f]));if(h&&k&&(n||q||b.m.H(e[f]),!v||!l))for(h=b.m.$(e[f]),k=0;k<this.cards.length;k++)if(this.cards[f].id===h){d.push(this.cards[f]);break}}0<
d.length&&a.cb(d)}};b.A.prototype.aa=function(a){var c=document.createElement("div");c.className="ab-feed ab-show";var d=document.createElement("div");d.className="ab-feed-buttons-wrapper";c.appendChild(d);var e=document.createElement("i");e.className="fa fa-times ab-close-button";e.onclick=function(d){d=d||window.event;b.A.U(a,c);d.stopPropagation()};d.appendChild(e);e=document.createElement("i");e.className="fa fa-refresh ab-refresh-button";e.onclick=function(b){b=b||window.event;this.className+=
" fa-spin";a.Ia();b.stopPropagation()};d.appendChild(e);c.appendChild(this.a(a));var f=this;c.onscroll=function(){f.Hb(a,c)};return c};b.A.prototype.Td=function(a,c){c.setAttribute(b.A.j,a)};b.A.prototype.Hc=function(a,c,d,e){this.cards=a;this.lastUpdated=c;null!=d&&(null==this.lastUpdated?b.A.U(e,d):(a=d.querySelectorAll(".ab-feed-body")[0],null!=a&&(c=this.a(e),a.parentNode.replaceChild(c,a),this.Hb(e,c.parentNode))))};b.h.V=240;b.h.S=490;b.h.prototype.U=function(a){a&&(a.className=a.className.replace("ab-show",
"ab-hide"),setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},b.h.V))};b.h.prototype.aa=function(){var a=this,c=document.createElement("div");c.className="ab-in-app-message ab-show";c.style.color=b.ba.ia(this.textColor);G(c,this.backgroundColor);var d=document.createElement("i");d.className="fa fa-times ab-close-button";d.onclick=function(b){b=b||window.event;a.U(c);a.S();b.stopPropagation()};d.style.color=b.ba.ia(this.closeButtonColor);c.appendChild(d);d=document.createElement("div");
d.className="ab-image-area";if(this.imageUrl){var e=document.createElement("img");e.setAttribute("src",this.imageUrl);d.appendChild(e);c.appendChild(d)}else if(this.icon){e=document.createElement("span");e.className="ab-icon";e.style.backgroundColor=b.ba.ia(this.iconBackgroundColor);e.style.color=b.ba.ia(this.iconColor);var f=document.createElement("i");f.className="fa fa-3x";f.appendChild(document.createTextNode(this.icon));e.appendChild(f);d.appendChild(e);c.appendChild(d)}d=document.createElement("span");
d.className="ab-message-text";this.header&&0<this.header.length&&(e=document.createElement("span"),e.className="ab-message-header",e.style.color=b.ba.ia(this.headerTextColor),e.appendChild(document.createTextNode(this.header)),d.appendChild(e));d.appendChild(document.createTextNode(this.message));c.appendChild(d);return c};b.fa.prototype.aa=function(a,c){var d=this,e=b.h.prototype.aa.call(this);e.className+=" ab-slideup ab-effect-slide";e.onclick=function(e){e=e||window.event;a.fb(d);d.clickAction===
b.h.j.URI?window.open(d.uri):d.clickAction===b.h.j.NEWS_FEED&&c();d.U(this);e.stopPropagation()};return e};b.Z.prototype.aa=function(a,c){var d=b.h.prototype.aa.call(this);d.className+=" ab-modal ab-effect-modal";E(d);F(this,a,c,d);return d};b.Y.prototype.aa=function(a,c){var d=b.h.prototype.aa.call(this);d.className+=" ab-fullscreen ab-effect-fullscreen";E(d);F(this,a,c,d);return d};b.Z.prototype.U=b.Y.prototype.U=function(a){for(var c=document.querySelectorAll(".ab-page-blocker"),d=null,e=0;e<c.length;e++)-1===
c[e].className.indexOf("ab-hide")&&(d=c[e]);d&&(d.className=d.className.replace("ab-show","ab-hide"),setTimeout(function(){d.parentNode&&d.parentNode.removeChild(d)},b.h.S));b.h.prototype.U.call(this,a)};var k=new H;f.ab=b;f.AF=H;f.initialize=k.Jb;f.destroy=k.Ea;f.toggleAppboyLogging=k.Wb;f.setLogger=k.Tb;f.openSession=k.hb;f.changeUser=k.Db;f.getUser=k.Za;f.requestImmediateDataFlush=k.Nb;f.requestFeedRefresh=k.Ia;f.getCachedFeed=k.Ya;f.subscribeToFeedUpdates=k.Dc;f.logCardImpressions=k.cb;f.logCardClick=
k.bb;f.requestInAppMessageRefresh=k.Ob;f.logInAppMessageImpression=k.gb;f.logInAppMessageClick=k.fb;f.logInAppMessageButtonClick=k.eb;f.subscribeToNewInAppMessages=k.Ec;f.removeSubscription=k.Q;f.removeAllSubscriptions=k.P;f.logCustomEvent=k.Kb;f.logPurchase=k.Lb;f.isAppboyPushSupported=k.Pd;f.registerAppboyPushMessages=k.Sd;f.unregisterAppboyPushMessages=k.$d;f.ab.User=b.f;f.ab.User.prototype.getUserId=b.f.prototype.K;f.ab.User.prototype.setFirstName=b.f.prototype.Jc;f.ab.User.prototype.setLastName=
b.f.prototype.Rc;f.ab.User.prototype.setEmail=b.f.prototype.vc;f.ab.User.prototype.setBio=b.f.prototype.S;f.ab.User.prototype.setGender=b.f.prototype.Kc;f.ab.User.prototype.setDateOfBirth=b.f.prototype.Ga;f.ab.User.prototype.setCountry=b.f.prototype.V;f.ab.User.prototype.setHomeCity=b.f.prototype.Mc;f.ab.User.prototype.setEmailNotificationSubscriptionType=b.f.prototype.be;f.ab.User.prototype.setPushNotificationSubscriptionType=b.f.prototype.Ac;f.ab.User.prototype.setPhoneNumber=b.f.prototype.Tc;f.ab.User.prototype.setAvatarImageUrl=
b.f.prototype.H;f.ab.User.prototype.setLastKnownLocation=b.f.prototype.Sb;f.ab.User.prototype.setUserAttribute=b.f.prototype.M;f.ab.User.prototype.setCustomUserAttribute=b.f.prototype.$;f.ab.User.prototype.addToCustomAttributeArray=b.f.prototype.j;f.ab.User.prototype.removeFromCustomAttributeArray=b.f.prototype.w;f.ab.User.prototype.incrementCustomUserAttribute=b.f.prototype.k;f.ab.User.Genders=b.f.V;f.ab.User.NotificationSubscriptionTypes=b.f.H;f.ab.InAppMessage=b.h;f.ab.InAppMessage.prototype.subscribeToClickedEvent=
b.h.prototype.V;f.ab.InAppMessage.prototype.subscribeToDismissedEvent=b.h.prototype.$;f.ab.InAppMessage.prototype.removeSubscription=b.h.prototype.Q;f.ab.InAppMessage.prototype.removeAllSubscriptions=b.h.prototype.P;f.ab.SlideUpMessage=b.fa;f.ab.ModalMessage=b.Z;f.ab.FullScreenMessage=b.Y;f.ab.InAppMessage.Button=b.h.a;f.ab.InAppMessage.Button.prototype.subscribeToClickedEvent=b.h.a.prototype.k;f.ab.InAppMessage.Button.prototype.removeSubscription=b.h.a.prototype.Q;f.ab.InAppMessage.Button.prototype.removeAllSubscriptions=
b.h.a.prototype.P;f.ab.InAppMessage.SlideFrom=b.h.H;f.ab.InAppMessage.ClickAction=b.h.j;f.ab.InAppMessage.DismissType=b.h.w;f.ab.Feed=b.A;f.ab.Feed.prototype.getUnreadCardCount=b.A.prototype.j;f.ab.Card=b.m;f.ab.ClassicCard=b.la;f.ab.CaptionedImage=b.ka;f.ab.Banner=b.Banner;if("undefined"!==typeof B){f.ADF=B;var w=new B(k);f.display=w;f.display.automaticallyShowNewInAppMessages=w.zd;f.display.showInAppMessage=w.Cc;f.display.showFeed=w.Bc;f.display.destroyFeed=w.Id}f.Vb=k.Vb;return f}
"function"===typeof define&&define.amd?define(["exports","require"],D):"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?D(module.exports||exports):D(window.appboy={});
